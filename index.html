<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8" />
  <title>Fortnite Mini</title>

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
    }

    body {
      background: #0d0d0d;
      color: #fff;
      text-align: center;
      padding-top: 20px;
    }

    #game-container {
      position: relative;
      margin: 20px auto;
      width: 900px;
      height: 450px;
      background: #1a1a1a;
      overflow: hidden;
      border: 4px solid #555;
    }

    #storm {
      position: absolute;
      border: 6px solid rgba(120, 0, 255, 0.7);
      box-shadow: 0 0 25px rgba(150, 0, 255, 0.9);
      pointer-events: none;
    }

    #player {
      position: absolute;
      width: 35px;
      height: 55px;
      background: #4caf50;
      bottom: 60px;
      left: 150px;
      border-radius: 4px;
    }

    #enemy {
      position: absolute;
      width: 35px;
      height: 55px;
      background: #e53935;
      bottom: 60px;
      right: 150px;
      border-radius: 4px;
    }

    #ground {
      position: absolute;
      left: 0;
      bottom: 0;
      width: 100%;
      height: 60px;
      background: #333;
    }

    #status {
      margin-top: 10px;
      font-size: 20px;
      font-weight: bold;
    }
  </style>
</head>

<body>
  <h1>Fortnite Mini</h1>
  <p>W/A/D for å bevege deg — SPACE for å hoppe</p>
  <p id="status">Overlev stormen!</p>

  <div id="game-container">
    <div id="storm"></div>
    <div id="player"></div>
    <div id="enemy"></div>
    <div id="ground"></div>
  </div>

  <script>
    const player = document.getElementById("player");
    const enemy = document.getElementById("enemy");
    const storm = document.getElementById("storm");
    const statusText = document.getElementById("status");

    let keys = {};

    let playerX = 150;
    let playerY = 0;
    let velY = 0;
    let onGround = true;

    let enemyX = 700;
    let enemyDir = -1;

    let stormLeft = 0;
    let stormTop = 0;
    let stormRight = 900;
    let stormBottom = 450;

    let gameOver = false;
    let startTime = Date.now();
    const winTime = 35000; // 35 sekunder

    document.addEventListener("keydown", e => keys[e.key.toLowerCase()] = true);
    document.addEventListener("keyup", e => keys[e.key.toLowerCase()] = false);

    function updatePlayer(dt) {
      const speed = 260;
      const gravity = 1000;
      const jumpForce = 520;

      if (keys["a"]) playerX -= speed * dt;
      if (keys["d"]) playerX += speed * dt;

      if ((keys[" "] || keys["w"]) && onGround) {
        velY = jumpForce;
        onGround = false;
      }

      velY -= gravity * dt;
      playerY += velY * dt;

      if (playerY <= 0) {
        playerY = 0;
        velY = 0;
        onGround = true;
      }

      if (playerX < 0) playerX = 0;
      if (playerX > 900 - 35) playerX = 900 - 35;

      player.style.left = playerX + "px";
      player.style.bottom = (60 + playerY) + "px";
    }

    function updateEnemy(dt) {
      const speed = 150;
      enemyX += enemyDir * speed * dt;

      if (enemyX < 450) enemyDir = 1;
      if (enemyX > 850) enemyDir = -1;

      enemy.style.left = enemyX + "px";
    }

    function rectsOverlap(ax, ay, aw, ah, bx, by, bw, bh) {
      return ax < bx + bw && ax + aw > bx && ay < by + bh && ay + ah > by;
    }

    function checkCollisions() {
      const p = {
        x: playerX,
        y: 450 - (60 + playerY) - 55,
        w: 35,
        h: 55
      };

      const e = {
        x: enemyX,
        y: 450 - 60 - 55,
        w: 35,
        h: 55
      };

      if (rectsOverlap(p.x, p.y, p.w, p.h, e.x, e.y, e.w, e.h)) {
        endGame(false, "Fienden tok deg!");
      }

      const playerTop = p.y;
      const playerLeft = p.x;
      const playerRight = p.x + p.w;

      if (
        playerLeft < stormLeft ||
        playerRight > stormRight ||
        playerTop < stormTop
      ) {
        endGame(false, "Stormen tok deg!");
      }
    }

    function updateStorm(dt) {
      const shrink = 12;

      stormLeft += shrink * dt;
      stormTop += shrink * dt;
      stormRight -= shrink * dt;
      stormBottom -= shrink * dt;

      if (stormRight - stormLeft < 300) return;

      storm.style.left = stormLeft + "px";
      storm.style.top = stormTop + "px";
      storm.style.width = (stormRight - stormLeft) + "px";
      storm.style.height = (stormBottom - stormTop) + "px";
    }

    function endGame(win, msg) {
      if (gameOver) return;
      gameOver = true;
      statusText.textContent = win ? "Du vant! " + msg : "Du tapte! " + msg;
    }

    let last = null;

    function loop(t) {
      if (!last) last = t;
      const dt = (t - last) / 1000;
      last = t;

      if (!gameOver) {
        updatePlayer(dt);
        updateEnemy(dt);
        updateStorm(dt);
        checkCollisions();

        if (Date.now() - startTime > winTime) {
          endGame(true, "Du overlevde stormen!");
        }
      }

      requestAnimationFrame(loop);
    }

    requestAnimationFrame(loop);
  </script>
</body>
</html>
